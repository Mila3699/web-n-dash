# üõ°Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –ó–∞—â–∏—Ç–∞ –æ—Ç XSS-–∞—Ç–∞–∫ (Cross-Site Scripting)

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—â–∏—Ç—ã:

#### 1. **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å—Å—ã–ª–∫–∞–º–∏**
- **–§–∞–π–ª**: `src/lib/sanitize.ts` ‚Üí `safeOpenLink()`
- **–ó–∞—â–∏—Ç–∞**: 
  - –í–∞–ª–∏–¥–∞—Ü–∏—è URL –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º
  - –†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ `http:`, `https:`, `mailto:`, `tel:` –ø—Ä–æ—Ç–æ–∫–æ–ª—ã
  - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ `javascript:`, `data:`, `vbscript:` –∏ –¥—Ä—É–≥–∏—Ö –æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
  - –ó–∞—â–∏—Ç–∞ –æ—Ç tabnabbing —á–µ—Ä–µ–∑ `noopener,noreferrer`
  - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `window.opener = null` –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

#### 2. **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage**
- **–§–∞–π–ª**: `src/lib/rateLimit.ts` ‚Üí `loadFromStorage()`
- **–ó–∞—â–∏—Ç–∞**:
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –≤—Å–µ—Ö –ø–æ–ª–µ–π
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ localStorage

#### 3. **–£—Ç–∏–ª–∏—Ç—ã —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏**
–§–∞–π–ª `src/lib/sanitize.ts` —Å–æ–¥–µ—Ä–∂–∏—Ç:

- `escapeHtml()` - —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML-—Å–∏–º–≤–æ–ª–æ–≤
- `sanitizeUrl()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞ URL
- `sanitizeString()` - —É–¥–∞–ª–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
- `isValidEmail()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è email
- `isValidPhone()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- `createTelegramUrl()` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Telegram URL
- `createWhatsAppUrl()` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ WhatsApp URL

#### 4. **Rate Limiting**
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ –∏ DDoS-–∞—Ç–∞–∫ –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

---

## üö´ –ß—Ç–æ –ó–ê–ü–†–ï–©–ï–ù–û –≤ –ø—Ä–æ–µ–∫—Ç–µ:

1. **dangerouslySetInnerHTML** - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º
2. **eval()** –∏ **Function()** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø—Ä–µ—â–µ–Ω—ã
3. **innerHTML** - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
4. **window.open()** –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ - –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `safeOpenLink()`
5. –ü—Ä—è–º–∞—è –≤—Å—Ç–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ –≤ HTML –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üìã Checklist –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

- ‚úÖ –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ `safeOpenLink()`
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ localStorage –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è
- ‚úÖ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è dangerouslySetInnerHTML —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º
- ‚úÖ React –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ JSX
- ‚úÖ Rate limiting –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —Å–ø–∞–º–∞
- ‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω—ã –∏ email –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

---

## üîê –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –¥–æ–±–∞–≤–∏—Ç—å:

1. **Content Security Policy (CSP)** –∑–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. **HTTPS** –¥–ª—è –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
3. **Subresource Integrity (SRI)** –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
4. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (`npm audit`)

### –ü—Ä–∏–º–µ—Ä CSP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:
```
Content-Security-Policy: 
  default-src 'self'; 
  script-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
  style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
  font-src 'self' https://fonts.gstatic.com; 
  img-src 'self' data: https:; 
  connect-src 'self' https://t.me https://wa.me;
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
- [React Security Best Practices](https://react.dev/learn/keeping-components-pure#side-effects-unintended-consequences)
- [Content Security Policy Guide](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-11-03
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü—Ä–æ–µ–∫—Ç –∑–∞—â–∏—â–µ–Ω –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö XSS-–∞—Ç–∞–∫
